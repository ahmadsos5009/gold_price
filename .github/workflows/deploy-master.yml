  
name: deploy-master
on: [push]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: borales/actions-yarn@v2.0.0
        with:
          cmd: install # will run `yarn install` command
      - uses: borales/actions-yarn@v2.0.0
        with:
          cmd: build # will run `yarn build` command

      - name: Update qy
        run: sudo apt-get update -qy
      - name: Installing lftp
        run: sudo apt-get install -y lftp

      - name: Send build To Over lftp
        run: lftp -c "set ftp:ssl-allow no; open -u epiz_26397561,r7ehK1nHPE ftpsite.com; mirror -v ./build/ /htdocs --reverse --ignore-time --parallel=10 --exclude-glob .git* --exclude .git/"
     
      - name: Installing Surge
        run: sudo npm install -g surge

      - name: Deploying website
        run: surge --project ./build/ --domain ${{ secrets.SURGE_DOMAIN }} --token ${{ secrets.SURGE_TOKEN }}

      - run: echo "Please visit => ${{ secrets.SURGE_DOMAIN }}"